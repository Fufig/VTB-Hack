# VTB-Hack: Прогнозирование переводов денежных средств между юридическими лицами

## Постановка задачи

Цель задачи — прогнозировать недельные объемы переводов денежных средств между юридическими лицами, являющимися клиентами банка.  
Модель должна предсказывать агрегированные суммы переводов на основе исторических транзакционных данных.

- Исторический период: 118 недель (с 0 по 117)
- Горизонт прогнозирования: 12 недель (с 118 по 129)
- Единица анализа: юридические лица, идентифицированные по ИНН
- Объем данных: `более 250 миллионов транзакций`

## Особенности данных

- Юридические лица могут иметь счета в нескольких банках. Данные включают транзакции как отправителей, так и получателей по каждому ИНН.
- В отличие от транзакций физических лиц, отсутствуют MCC-коды, но присутствуют другие полезные признаки.
- Масштаб данных открывает широкие возможности для качественного моделирования.

## Подход к решению

### 1. Предобработка данных

- Использована библиотека `polars` для высокопроизводительной обработки большого объема данных
- Разработка 3 принципиально разных предобработок с извлечением разных признаков, обучение простых моделей для оценки их важности
- Оценка качества обучения моделей с использованием разных промежутков исторических временных отрезков

#### Почему Polars?

[Polars](https://www.pola.rs/) — это современная, высокопроизводительная библиотека для анализа данных, разработанная на языке Rust. Она предоставляет интерфейс для Python и ориентирована на эффективную обработку больших объёмов данных.

### Преимущества Polars по сравнению с Pandas:

- **Производительность**: Polars значительно быстрее Pandas за счёт параллельной обработки данных и низкоуровневой оптимизации.
- **Меньшее потребление памяти**: благодаря колоночному хранению и использованию Apache Arrow под капотом.
- **Безопасность типов и чистый API**: строгая типизация и декларативный стиль выражений позволяют писать более надёжный и читаемый код.
- **Параллельность из коробки**: Polars автоматически использует все доступные ядра CPU, что критично при работе с большими датасетами.
- **Поддержка выражений и lazy computation**: позволяет откладывать выполнение до момента, когда это действительно необходимо, тем самым оптимизируя пайплайн.

Благодаря этим свойствам, Polars стал идеальным выбором для работы с транзакционными данными объёмом в сотни миллионов строк в рамках данного проекта.


### 2. Моделирование

- Использованы модели машинного обучения:
  - `CatBoostRegressor`
  - `XGBoostRegressor`
- Настройка гиперпараметров с помощью `Optuna` для повышения качества моделей

### 3. Ансамблирование

- Построен ансамбль на основе взвешенного усреднения предсказаний лучших моделей
- Выбор конфигураций производился на основе метрики MSLE на валидационном наборе

## Результаты

- Решение показало довольно хорошие результаты
- Подход масштабируем и легко обновляется при поступлении новых транзакций


